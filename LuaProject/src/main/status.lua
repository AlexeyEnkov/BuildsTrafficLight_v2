return function(succCb, failCb)    local busy = false    local bStatus    local rStatus = C.OK    local idInd = 1;    local ids    local CFG = _G["cfg"]    local function nextId()        busy = true        local id = ids[idInd]        idInd = idInd + 1;        if bStatus ~= C.B_FAIL and id and rStatus == C.OK then            for i, v in pairs(CFG.ignoredIds) do                if id == v then busy = false return end            end            http.get("http://" .. CFG.ip .. ":" .. CFG.port .. "/guestAuth/app/rest/buildTypes/id:" .. id .. "/builds/?locator=count:2,running:any",                "Accept: application/json\r\n",                function(code, data)                    local function safe(code, data)                        busy = false                        if (code ~= 200) then                            if (code < 0) then                                rStatus = C.C_ERR                            else                                rStatus = C.R_ERR                            end                        else                            local json = cjson.decode(data)                            data = nil                            local len = #json.build                            if (len > 0) then                                if (json.build[1]).status == "FAILURE" then                                    bStatus = C.B_FAIL _G["targetId"] = id                                else                                    if (len >= 2) then                                        if (json.build[1]).state == "running" and (json.build[2]).status == "FAILURE" then                                            bStatus = C.B_RUN _G["targetId"] = id                                        end                                    end                                end                            end                            json = nil                        end                    end                    if not pcall(safe, code, data) then                        rStatus = C.P_ERR                    end                end)        else            if rStatus == C.OK then                if bStatus == nil then bStatus = C.B_SUCC end                succCb(bStatus)            else                failCb(rStatus)            end            tmr.unregister(C.STAT_TMR)            ids = nil        end    end    if wifi.sta.status() == wifi.STA_GOTIP then        file.open("ids")        local k        k, ids = pcall(cjson.decode, file.read())        file.close()        if k then            tmr.register(C.STAT_TMR,                10,                tmr.ALARM_AUTO,                function()                    if busy then return end                    nextId()                end)            tmr.start(C.STAT_TMR)        else            failCb(C.P_ERR)        end    else        failCb(C.WIFI_ERR)    endend